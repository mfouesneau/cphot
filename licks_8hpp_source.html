<!-- HTML header for doxygen 1.9.2-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>cphot: /home/runner/work/cphot/cphot/include/cphot/licks.hpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">cphot<span id="projectnumber">&#160;0.1</span>
   </div>
   <div id="projectbrief">A C++ tool for computing photometry from spectra.</div>
  </td>
 </tr>
   <!--BEGIN FULL_SIDEBAR-->
   <tr><td colspan="2">        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td></tr>
   <!--END FULL_SIDEBAR-->
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('licks_8hpp_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">licks.hpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="licks_8hpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * @defgroup LICKS Lick indices</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> * @brief Lick indices calculations</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> * This package provides function to compute spectral indices.</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> * We provide a collection of many common indices. The Lick system of spectral</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> * line indices is one of the most commonly used methods of determining ages and</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> * metallicities of unresolved (integrated light) stellar populations.</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> * The calibration of the Lick/ IDS system is complicated because the original</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> * Lick spectra were not flux calibrated, so there are usually systematic</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> * effects due to differences in continuum shape.  Proper calibration involves</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> * observing many of the original Lick/IDS standard stars and deriving offsets</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> * to the standard system.</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> * references:</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"> * - Worthey G., Faber S. M., Gonzalez J. J., Burstein D., 1994, ApJS, 94, 687</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"> * - Worthey G., Ottaviani D. L., 1997, ApJS, 111, 377</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"> * - Puzia et al. 2002</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"> * - Zhang, Li &amp; Han 2005, http://arxiv.org/abs/astro-ph/0508634v1</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment"> * @note</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment"> * In Vazdekis et al. (2010), we propose a new Line Index System, hereafter LIS,</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment"> * with three new spectral resolutions at which to measure the Lick indices.</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment"> * Note that this new system should not be restricted to the Lick set of indices</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment"> * in a flux calibrated system. In fact, LIS can be used for any index in the</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment"> * literature (e.g., for the Rose (1984) indices), including newly defined</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment"> * indices (e.g., Cervantes &amp; Vazdekis 2009).</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment"> * The LIS system is defined for 3 different spectral resolutions which are best</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment"> * suited for the following astrophysical cases:</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment"> * - LIS-5.0AA: globular clusters</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment"> * - LIS-8.4AA: low and intermediate-mass galaxies</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment"> * - LIS-14.0AA: massive galaxies</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment"> * Conversions to transform the data from the Lick/IDS system to LIS can be found</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment"> * with discussion of indices and information in Johansson, Thomas &amp; Maraston (2010)</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment"> * http://wwwmpa.mpa-garching.mpg.de/~jonasj/milesff/milesff.pdf</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &lt;cmath&gt;</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="rquantities_8hpp.html">cphot/rquantities.hpp</a>&gt;</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="licks__data_8hpp.html">cphot/hardcoded_data/licks_data.hpp</a>&gt;</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160; </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacecphot.html">cphot</a>{</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="keyword">using</span> <a class="code" href="namespacecphot.html#a56ce8634b8975e1c85f2ca2fb13c45a5">DMatrix</a> = xt::xarray&lt;double, xt::layout_type::row_major&gt;;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment"> * @ingroup LICKS</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment"> * @brief Adapt the resolution of the spectra to match the lick definitions.</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment"> * Lick definitions have different resolution elements as function of wavelength.</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment"> * These definition are hard-coded in this function</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment"> * @param w</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment"> *         wavelength definition in Angstrom</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment"> * @param flux</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment"> *         spectra to convert</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment"> * @param fwhm0</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment"> *         initial broadening in the spectra `fi`</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment"> * @param sigma_floor</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment"> *         minimal dispersion to consider</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment"> * @return flux_red reduced spectra</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00067"></a><span class="lineno"><a class="line" href="group___l_i_c_k_s.html#ga2bf40c92789fad5c26426aa85f659303">   67</a></span>&#160;<a class="code" href="namespacecphot.html#a56ce8634b8975e1c85f2ca2fb13c45a5">DMatrix</a> <a class="code" href="group___l_i_c_k_s.html#ga2bf40c92789fad5c26426aa85f659303">reduce_resolution</a>(<span class="keyword">const</span> <a class="code" href="namespacecphot.html#a56ce8634b8975e1c85f2ca2fb13c45a5">DMatrix</a>&amp; w, <span class="keyword">const</span> <a class="code" href="namespacecphot.html#a56ce8634b8975e1c85f2ca2fb13c45a5">DMatrix</a>&amp; <a class="code" href="namespacecphot__sun__theoretical.html#a4fcc5fd99a9cfad076e8fafd642440eb">flux</a>, <span class="keywordtype">double</span> fwhm0, <span class="keywordtype">double</span> sigma_floor){</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="comment">// all in AA</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacecphot.html#a56ce8634b8975e1c85f2ca2fb13c45a5">DMatrix</a> w_lick_res {4000., 4400., 4900., 5400., 6000.};  <span class="comment">// Lick resolution anchor points in AA</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacecphot.html#a56ce8634b8975e1c85f2ca2fb13c45a5">DMatrix</a> lick_res   {11.5, 9.2, 8.4, 8.4, 9.8};           <span class="comment">// FWHM in AA</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="comment">// Linear interpolation of lick_res over w</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="comment">// TODO: need to add extrapolation</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <a class="code" href="namespacecphot.html#a56ce8634b8975e1c85f2ca2fb13c45a5">DMatrix</a> res = xt::interp(w, w_lick_res, lick_res);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="comment">// Compute width from fwhm</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="keywordtype">double</span> constant = 2. * std::sqrt(2. * std::log(2));     <span class="comment">// constant that converts fwhm --&gt; sigma</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <a class="code" href="namespacecphot.html#a56ce8634b8975e1c85f2ca2fb13c45a5">DMatrix</a> lick_sigma = xt::sqrt((res * res - fwhm0 * fwhm0)) / constant;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="comment">// Convolution by g=1/sqrt(2*pi*sigma^2) * exp(-r^2/(2*sigma^2))</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <a class="code" href="namespacecphot.html#a56ce8634b8975e1c85f2ca2fb13c45a5">DMatrix</a> flux_red = xt::zeros&lt;double&gt;({<a class="code" href="namespacecphot__sun__theoretical.html#a4fcc5fd99a9cfad076e8fafd642440eb">flux</a>.size()});</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160; </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i=0; i &lt; lick_sigma.size(); ++i){</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        <span class="keywordtype">double</span> sigma = lick_sigma(i);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <span class="keywordtype">double</span> maxsigma = 3. * sigma;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        <span class="comment">// sampling floor: min (0.2, sigma * 0.1)</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        <span class="keywordtype">double</span> delta = std::min(sigma_floor, sigma * 0.1);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        <a class="code" href="namespacecphot.html#a56ce8634b8975e1c85f2ca2fb13c45a5">DMatrix</a> delta_wj = xt::arange(-maxsigma, + maxsigma, delta);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        <span class="keyword">auto</span> wj = delta_wj + w[i];</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        <span class="keyword">auto</span> fluxj = xt::interp(wj, w, <a class="code" href="namespacecphot__sun__theoretical.html#a4fcc5fd99a9cfad076e8fafd642440eb">flux</a>, 0., 0.);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        flux_red[i] = xt::sum(fluxj * delta * xt::exp(-0.5 * xt::pow(delta_wj / sigma, 2)))();</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    }</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    flux_red /= lick_sigma * constant;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="keywordflow">return</span> flux_red;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;}</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment"> * @ingroup LICKS</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment"> * @brief Define a Lick Index similarily to a Filter object</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00101"></a><span class="lineno"><a class="line" href="classcphot_1_1_lick_index.html">  101</a></span>&#160;<span class="keyword">class </span><a class="code" href="classcphot_1_1_lick_index.html">LickIndex</a>{</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160; </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keyword">private</span>:</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        std::string name;             <span class="comment">///&lt; name of the index</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment"></span>        <span class="keywordtype">double</span> index_band_min;        <span class="comment">///&lt; minimal wavelength of index interval</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment"></span>        <span class="keywordtype">double</span> index_band_max;        <span class="comment">///&lt; maximal wavelength of index interval</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment"></span>        <span class="keywordtype">double</span> blue_continuum_min;    <span class="comment">///&lt; minimal wavelength of blue continuum</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment"></span>        <span class="keywordtype">double</span> blue_continuum_max;    <span class="comment">///&lt; maximal wavelength of blue continuum</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment"></span>        <span class="keywordtype">double</span> red_continuum_min;     <span class="comment">///&lt; minimal wavelength of red continuum</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment"></span>        <span class="keywordtype">double</span> red_continuum_max;     <span class="comment">///&lt; maximal wavelength of red continuum</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment"></span>        QLength wavelength_unit;      <span class="comment">///&lt; wavelength unit (usually Angstrom or nm)</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment"></span>        <span class="keywordtype">bool</span>    b_mag;                <span class="comment">///&lt; is the index in magnitudes? (or equivalent width)</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment"></span>        std::string description;      <span class="comment">///&lt; description/notes</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keyword">public</span>:</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        <a class="code" href="classcphot_1_1_lick_index.html#a6a429c6546a656a73ea03d1ef4697712">LickIndex</a>(<span class="keyword">const</span> std::string&amp; name, <span class="keywordtype">double</span> index_band_min, <span class="keywordtype">double</span> index_band_max,</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                  <span class="keywordtype">double</span> blue_continuum_min, <span class="keywordtype">double</span> blue_continuum_max,</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                  <span class="keywordtype">double</span> red_continuum_min, <span class="keywordtype">double</span> red_continuum_max,</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                  <span class="keyword">const</span> QLength &amp; wavelength_unit, <span class="keyword">const</span> std::string&amp; description,</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                  <span class="keywordtype">bool</span> <a class="code" href="classcphot_1_1_lick_index.html#af2978a172465f15ee57f7c559a74e32e">is_mag</a>);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        <a class="code" href="classcphot_1_1_lick_index.html#a6a429c6546a656a73ea03d1ef4697712">LickIndex</a>(<span class="keyword">const</span> <a class="code" href="structcphot__licks_1_1lickdata.html">cphot_licks::lickdata</a>&amp; data);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160; </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="classcphot_1_1_lick_index.html#a5de098256e0088ae6222e94b9a67bc58">get</a>(<span class="keyword">const</span> <a class="code" href="namespacecphot.html#a56ce8634b8975e1c85f2ca2fb13c45a5">DMatrix</a>&amp; w, <span class="keyword">const</span> <a class="code" href="namespacecphot.html#a56ce8634b8975e1c85f2ca2fb13c45a5">DMatrix</a>&amp; <a class="code" href="namespacecphot__sun__theoretical.html#a4fcc5fd99a9cfad076e8fafd642440eb">flux</a>, <span class="keyword">const</span> QLength &amp; wavelength_unit);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        std::string <a class="code" href="classcphot_1_1_lick_index.html#ad1491361a02f3a807359f774263c6d0e">get_name</a>() <span class="keyword">const</span>;</div>
<div class="line"><a name="l00126"></a><span class="lineno"><a class="line" href="classcphot_1_1_lick_index.html#af2978a172465f15ee57f7c559a74e32e">  126</a></span>&#160;        <span class="keywordtype">bool</span> <a class="code" href="classcphot_1_1_lick_index.html#af2978a172465f15ee57f7c559a74e32e">is_mag</a>() {<span class="keywordflow">return</span> this-&gt;b_mag;}</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160; </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classcphot_1_1_lick_index.html#a3a6724063de1f83fe4db71896427ac1f">info</a>() <span class="keyword">const</span>;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">         * void get_continuum_normalized_region_around_line(const DMatrix &amp; wi,</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">         *                                                  const DMatrix &amp; flux);</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;};</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment"> * @brief Construct a new Lick Index:: Lick Index object</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment"> * @param name                name of the index</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment"> * @param index_band_min      minimal wavelength of index interval</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment"> * @param index_band_max      maximal wavelength of index interval</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment"> * @param blue_continuum_min  minimal wavelength of blue continuum</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment"> * @param blue_continuum_max  maximal wavelength of blue continuum</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment"> * @param red_continuum_min   minimal wavelength of red continuum</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment"> * @param red_continuum_max   maximal wavelength of red continuum</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment"> * @param wavelength_unit     wavelength unit (usually Angstrom or nm)</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment"> * @param description         description/notes</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00149"></a><span class="lineno"><a class="line" href="classcphot_1_1_lick_index.html#a6a429c6546a656a73ea03d1ef4697712">  149</a></span>&#160;<a class="code" href="classcphot_1_1_lick_index.html#a6a429c6546a656a73ea03d1ef4697712">LickIndex::LickIndex</a>(<span class="keyword">const</span> std::string&amp; name, <span class="keywordtype">double</span> index_band_min, <span class="keywordtype">double</span> index_band_max,</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                     <span class="keywordtype">double</span> blue_continuum_min, <span class="keywordtype">double</span> blue_continuum_max,</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                     <span class="keywordtype">double</span> red_continuum_min, <span class="keywordtype">double</span> red_continuum_max,</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                     <span class="keyword">const</span> QLength&amp; <a class="code" href="namespacecphot__sun__theoretical.html#af87284c9a76c080728b33c14948be461">wavelength_unit</a>, <span class="keyword">const</span> std::string&amp; description, <span class="keywordtype">bool</span> is_mag)</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;            : name(name), index_band_min(index_band_min), index_band_max(index_band_max),</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;              blue_continuum_min(blue_continuum_min), blue_continuum_max(blue_continuum_max),</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;              red_continuum_min(red_continuum_min), red_continuum_max(red_continuum_max),</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;              <a class="code" href="namespacecphot__sun__theoretical.html#af87284c9a76c080728b33c14948be461">wavelength_unit</a>(<a class="code" href="namespacecphot__sun__theoretical.html#af87284c9a76c080728b33c14948be461">wavelength_unit</a>), description(description), b_mag(is_mag){}</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment"> * @brief Construct a new Lick Index:: Lick Index object</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment"> * @param data  data from the hardcoded data indices</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00163"></a><span class="lineno"><a class="line" href="classcphot_1_1_lick_index.html#ad1f4dfed15e526720018dc123b325bd9">  163</a></span>&#160;<a class="code" href="classcphot_1_1_lick_index.html#a6a429c6546a656a73ea03d1ef4697712">LickIndex::LickIndex</a>(<span class="keyword">const</span> <a class="code" href="structcphot__licks_1_1lickdata.html">cphot_licks::lickdata</a>&amp; data)</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;            : name(data.name), index_band_min(data.index_band_min), index_band_max(data.index_band_max),</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;              blue_continuum_min(data.blue_continuum_min), blue_continuum_max(data.blue_continuum_max),</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;              red_continuum_min(data.red_continuum_min), red_continuum_max(data.red_continuum_max),</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;              <a class="code" href="namespacecphot__sun__theoretical.html#af87284c9a76c080728b33c14948be461">wavelength_unit</a>(data.<a class="code" href="namespacecphot__sun__theoretical.html#af87284c9a76c080728b33c14948be461">wavelength_unit</a>), b_mag(data.is_mag){}</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment"> * @brief Get the name object</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment"> * @return std::string</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00174"></a><span class="lineno"><a class="line" href="classcphot_1_1_lick_index.html#ad1491361a02f3a807359f774263c6d0e">  174</a></span>&#160;std::string <a class="code" href="classcphot_1_1_lick_index.html#ad1491361a02f3a807359f774263c6d0e">LickIndex::get_name</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="keywordflow">return</span> this-&gt;name;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;}</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160; </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment"> * @brief display some information about the index</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00183"></a><span class="lineno"><a class="line" href="classcphot_1_1_lick_index.html#a3a6724063de1f83fe4db71896427ac1f">  183</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcphot_1_1_lick_index.html#a3a6724063de1f83fe4db71896427ac1f">LickIndex::info</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="keywordtype">double</span> wave_conv = this-&gt;wavelength_unit.to(<a class="code" href="rquantities_8hpp.html#a684e16413e0535dee3da92fe75d71e92">nm</a>);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160; </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Lick Index: &quot;</span> &lt;&lt; this-&gt;name &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;  Index band: [&quot;</span> &lt;&lt; this-&gt;index_band_min * wave_conv &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; this-&gt;index_band_max * wave_conv &lt;&lt; <span class="stringliteral">&quot;] nm&quot;</span> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;  Blue continuum: [&quot;</span> &lt;&lt; this-&gt;blue_continuum_min * wave_conv &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; this-&gt;blue_continuum_max * wave_conv &lt;&lt; <span class="stringliteral">&quot;] nm&quot;</span> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;  Red continuum: [&quot;</span> &lt;&lt; this-&gt;red_continuum_min * wave_conv &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; this-&gt;red_continuum_max * wave_conv &lt;&lt; <span class="stringliteral">&quot;] nm&quot;</span> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;  Expressed value in &quot;</span> &lt;&lt; (this-&gt;b_mag ? <span class="stringliteral">&quot;magnitude&quot;</span> : <span class="stringliteral">&quot;equivalent-width&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;}</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160; </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment"> * void LickIndex::get_continuum_normalized_region_around_line(</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment"> *     const DMatrix &amp; wi, const DMatrix &amp; flux</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment"> * ){</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment"> *     auto ind_cont = xt::argwhere(</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment"> *         ( (wi &gt;= this-&gt;blue_continuum_min) &amp;&amp; (wi &lt;= this-&gt;blue_continuum_max) ) ||</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment"> *         ( (wi &gt;= this-&gt;red_continuum_min)  &amp;&amp; (wi &lt;= this-&gt;red_continuum_max)  )</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment"> *         );</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment"> *     auto ind_range = xt::argwhere(</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment"> *         ( (wi &gt; this-&gt;index_band_min) &amp;&amp; (wi &lt; this-&gt;index_band_max) )</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment"> *         );</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment"> *     const DMatrix &amp; wnew = wi[ind_range];</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment"> *     const DMatrix &amp; wcont = wi[ind_cont];</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment"> *     // Make a flux array of shape (ind_range.size()))</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment"> * }</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment"> * @brief compute spectral index after continuum subtraction</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment"> * @param w         array of wavelengths in AA</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment"> * @param flux      array of flux values for different spectra in the series</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment"> * @return double   equivalent width or magnitude</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00220"></a><span class="lineno"><a class="line" href="classcphot_1_1_lick_index.html#a5de098256e0088ae6222e94b9a67bc58">  220</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="classcphot_1_1_lick_index.html#a5de098256e0088ae6222e94b9a67bc58">LickIndex::get</a>(<span class="keyword">const</span> <a class="code" href="namespacecphot.html#a56ce8634b8975e1c85f2ca2fb13c45a5">DMatrix</a>&amp; w,</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                      <span class="keyword">const</span> <a class="code" href="namespacecphot.html#a56ce8634b8975e1c85f2ca2fb13c45a5">DMatrix</a>&amp; <a class="code" href="namespacecphot__sun__theoretical.html#a4fcc5fd99a9cfad076e8fafd642440eb">flux</a>,</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                      <span class="keyword">const</span> QLength &amp; <a class="code" href="namespacecphot__sun__theoretical.html#af87284c9a76c080728b33c14948be461">wavelength_unit</a>){</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160; </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="keywordtype">double</span> wave_conv =wavelength_unit.to(<a class="code" href="rquantities_8hpp.html#acb72ad7712b661794302d52b25becda0">angstrom</a>);</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <a class="code" href="namespacecphot.html#a56ce8634b8975e1c85f2ca2fb13c45a5">DMatrix</a> w_aa = w * wave_conv;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160; </div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160; </div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;}</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment"> * @brief Nice representation of Filter objects</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment"> * @param os   stream to output the representation</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment"> * @param F    Filter object</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment"> * @return std::ostream&amp;  same as os</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00238"></a><span class="lineno"><a class="line" href="namespacecphot.html#a24be7a22a2db338b1de4da903fca497e">  238</a></span>&#160;std::ostream &amp; <a class="code" href="namespacecphot.html#a6d96e44b33e1e570169fc104b36fc092">operator&lt;&lt;</a>(std::ostream &amp;os,</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                          <a class="code" href="classcphot_1_1_lick_index.html">LickIndex</a> &amp;index){</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;LickIndex: &quot;</span> &lt;&lt; index.<a class="code" href="classcphot_1_1_lick_index.html#ad1491361a02f3a807359f774263c6d0e">get_name</a>()</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;       &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="keywordflow">return</span> os;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;}</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment"> * @ingroup LICKS</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment"> * @brief Collection of Lick indices</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00249"></a><span class="lineno"><a class="line" href="classcphot_1_1_lick_library.html">  249</a></span>&#160;<span class="keyword">class </span><a class="code" href="classcphot_1_1_lick_library.html">LickLibrary</a>{</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="keyword">private</span>:</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        std::vector&lt;LickIndex&gt; licks;  <span class="comment">///&lt; registered lick indices</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="keyword">public</span>:</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        <a class="code" href="classcphot_1_1_lick_library.html#aa438a6ca8a1731ef28c73fe9ceadb8df">LickLibrary</a>();</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        std::vector&lt;std::string&gt; <a class="code" href="classcphot_1_1_lick_library.html#a4022ed25e20bb663e9d5f51852cd2d28">get_content</a>();</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        std::vector&lt;std::string&gt; <a class="code" href="classcphot_1_1_lick_library.html#a15bfa1073cf6515a7fb1c5a275e37e8a">find</a> (<span class="keyword">const</span> std::string &amp; name,</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                                       <span class="keywordtype">bool</span> case_sensitive=<span class="keyword">true</span>);</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        <a class="code" href="classcphot_1_1_lick_index.html">LickIndex</a> <a class="code" href="classcphot_1_1_lick_library.html#a2d66054dac73a2b5beb5c39eb7469008">load_filter</a>(<span class="keyword">const</span> std::string&amp; filter_name);</div>
<div class="line"><a name="l00259"></a><span class="lineno"><a class="line" href="classcphot_1_1_lick_library.html#a3d383d90264765821999fca3e8c76820">  259</a></span>&#160;        <span class="keywordtype">size_t</span> <a class="code" href="classcphot_1_1_lick_library.html#a3d383d90264765821999fca3e8c76820">size</a>(){<span class="keywordflow">return</span> this-&gt;licks.size();};</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160; </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;};</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment"> * @brief Construct a new Lick Library from hard coded definitions</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment"> * @see `cphot_licks::lickdefs`</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00269"></a><span class="lineno"><a class="line" href="classcphot_1_1_lick_library.html#aa438a6ca8a1731ef28c73fe9ceadb8df">  269</a></span>&#160;<a class="code" href="classcphot_1_1_lick_library.html#aa438a6ca8a1731ef28c73fe9ceadb8df">LickLibrary::LickLibrary</a>(){</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> index: <a class="code" href="namespacecphot__licks.html#a5b79dfe60e18681c7575566f070f4550">cphot_licks::lickdefs</a>){</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        this-&gt;licks.push_back(<a class="code" href="classcphot_1_1_lick_index.html">LickIndex</a>(index));</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    }</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;}</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment"> * @brief returns the list of lick indices registered</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment"> * @return std::vector&lt;std::string&gt; list of the indices</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00280"></a><span class="lineno"><a class="line" href="classcphot_1_1_lick_library.html#a4022ed25e20bb663e9d5f51852cd2d28">  280</a></span>&#160;std::vector&lt;std::string&gt; <a class="code" href="classcphot_1_1_lick_library.html#a4022ed25e20bb663e9d5f51852cd2d28">LickLibrary::get_content</a>(){</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    std::vector&lt;std::string&gt; lst;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; index: this-&gt;licks){</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        lst.push_back(index.get_name());</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    }</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="keywordflow">return</span> lst;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;}</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment"> * @brief Look for lick index names</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment"> * @param name                      name to look for</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment"> * @param case_sensitive            set if the case needs to be respected (default true)</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment"> * @return std::vector&lt;std::string&gt; list of potential candidates</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00295"></a><span class="lineno"><a class="line" href="classcphot_1_1_lick_library.html#a15bfa1073cf6515a7fb1c5a275e37e8a">  295</a></span>&#160;std::vector&lt;std::string&gt; <a class="code" href="classcphot_1_1_lick_library.html#a15bfa1073cf6515a7fb1c5a275e37e8a">LickLibrary::find</a> (<span class="keyword">const</span> std::string &amp; name,</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                                            <span class="keywordtype">bool</span> case_sensitive){</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160; </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    std::vector&lt;std::string&gt; result;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160; </div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="keywordflow">if</span> (case_sensitive) {</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; lib_name: this-&gt;<a class="code" href="classcphot_1_1_lick_library.html#a4022ed25e20bb663e9d5f51852cd2d28">get_content</a>()) {</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;            <span class="keywordflow">if</span> (lib_name.find(name) != std::string::npos)</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                result.push_back(lib_name);</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        }</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        std::string name_lower = <a class="code" href="helpers_8hpp.html#a0a909be5c801f2d1259dc32bbbdc83e7">tolower</a>(name);</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; lib_name: this-&gt;<a class="code" href="classcphot_1_1_lick_library.html#a4022ed25e20bb663e9d5f51852cd2d28">get_content</a>()) {</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="helpers_8hpp.html#a0a909be5c801f2d1259dc32bbbdc83e7">tolower</a>(lib_name).<a class="code" href="classcphot_1_1_lick_library.html#a15bfa1073cf6515a7fb1c5a275e37e8a">find</a>(name) != std::string::npos)</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                result.push_back(lib_name);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        }</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    }</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;}</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment"> * @brief Load a given filter from the library</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment"> * @param filter_name   normalized names according to the library</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment"> * @return Filter object</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00321"></a><span class="lineno"><a class="line" href="classcphot_1_1_lick_library.html#a2d66054dac73a2b5beb5c39eb7469008">  321</a></span>&#160;<a class="code" href="classcphot_1_1_lick_index.html">LickIndex</a> <a class="code" href="classcphot_1_1_lick_library.html#a2d66054dac73a2b5beb5c39eb7469008">LickLibrary::load_filter</a>(<span class="keyword">const</span> std::string&amp; filter_name){</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; index: this-&gt;licks){</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        <span class="keywordflow">if</span> (index.get_name() == filter_name){</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;            <span class="keywordflow">return</span> index;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        }</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    }</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Filter &quot;</span> + filter_name + <span class="stringliteral">&quot; not found in library&quot;</span>);</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;}</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment"> * @brief Nice representation of LickLibrary</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment"> * @param os   stream to output the representation</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment"> * @param F    Filter object</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment"> * @return std::ostream&amp;  same as os</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00337"></a><span class="lineno"><a class="line" href="namespacecphot.html#ab694996a0cf24e96e4e95457b0799c49">  337</a></span>&#160;std::ostream &amp; <a class="code" href="namespacecphot.html#a6d96e44b33e1e570169fc104b36fc092">operator&lt;&lt;</a>(std::ostream &amp;os,</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                          <a class="code" href="classcphot_1_1_lick_library.html">LickLibrary</a> &amp;l){</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;LicLibrary: &quot;</span> &lt;&lt; <span class="stringliteral">&quot;   Contains &quot;</span> &lt;&lt; l.<a class="code" href="classcphot_1_1_lick_library.html#a3d383d90264765821999fca3e8c76820">size</a>() &lt;&lt; <span class="stringliteral">&quot; registered indices.&quot;</span> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="keywordflow">return</span> os;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;}</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160; </div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;}<span class="comment">// namespace cphot</span></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="aclasscphot_1_1_lick_library_html_a15bfa1073cf6515a7fb1c5a275e37e8a"><div class="ttname"><a href="classcphot_1_1_lick_library.html#a15bfa1073cf6515a7fb1c5a275e37e8a">cphot::LickLibrary::find</a></div><div class="ttdeci">std::vector&lt; std::string &gt; find(const std::string &amp;name, bool case_sensitive=true)</div><div class="ttdoc">Look for lick index names.</div><div class="ttdef"><b>Definition:</b> <a href="licks_8hpp_source.html#l00295">licks.hpp:295</a></div></div>
<div class="ttc" id="alicks__data_8hpp_html"><div class="ttname"><a href="licks__data_8hpp.html">licks_data.hpp</a></div></div>
<div class="ttc" id="anamespacecphot__sun__theoretical_html_a4fcc5fd99a9cfad076e8fafd642440eb"><div class="ttname"><a href="namespacecphot__sun__theoretical.html#a4fcc5fd99a9cfad076e8fafd642440eb">cphot_sun_theoretical::flux</a></div><div class="ttdeci">const std::vector&lt; double &gt; flux</div><div class="ttdef"><b>Definition:</b> <a href="sun__data_8hpp_source.html#l00017">sun_data.hpp:17</a></div></div>
<div class="ttc" id="aclasscphot_1_1_lick_index_html"><div class="ttname"><a href="classcphot_1_1_lick_index.html">cphot::LickIndex</a></div><div class="ttdoc">Define a Lick Index similarily to a Filter object.</div><div class="ttdef"><b>Definition:</b> <a href="licks_8hpp_source.html#l00101">licks.hpp:101</a></div></div>
<div class="ttc" id="anamespacecphot_html_a6d96e44b33e1e570169fc104b36fc092"><div class="ttname"><a href="namespacecphot.html#a6d96e44b33e1e570169fc104b36fc092">cphot::operator&lt;&lt;</a></div><div class="ttdeci">std::ostream &amp; operator&lt;&lt;(std::ostream &amp;os, Filter &amp;F)</div><div class="ttdoc">Nice representation of Filter objects.</div><div class="ttdef"><b>Definition:</b> <a href="filter_8hpp_source.html#l00165">filter.hpp:165</a></div></div>
<div class="ttc" id="aclasscphot_1_1_lick_library_html_a3d383d90264765821999fca3e8c76820"><div class="ttname"><a href="classcphot_1_1_lick_library.html#a3d383d90264765821999fca3e8c76820">cphot::LickLibrary::size</a></div><div class="ttdeci">size_t size()</div><div class="ttdef"><b>Definition:</b> <a href="licks_8hpp_source.html#l00259">licks.hpp:259</a></div></div>
<div class="ttc" id="agroup___l_i_c_k_s_html_ga2bf40c92789fad5c26426aa85f659303"><div class="ttname"><a href="group___l_i_c_k_s.html#ga2bf40c92789fad5c26426aa85f659303">cphot::reduce_resolution</a></div><div class="ttdeci">DMatrix reduce_resolution(const DMatrix &amp;w, const DMatrix &amp;flux, double fwhm0, double sigma_floor)</div><div class="ttdoc">Adapt the resolution of the spectra to match the lick definitions.</div><div class="ttdef"><b>Definition:</b> <a href="licks_8hpp_source.html#l00067">licks.hpp:67</a></div></div>
<div class="ttc" id="arquantities_8hpp_html"><div class="ttname"><a href="rquantities_8hpp.html">rquantities.hpp</a></div></div>
<div class="ttc" id="aclasscphot_1_1_lick_index_html_a3a6724063de1f83fe4db71896427ac1f"><div class="ttname"><a href="classcphot_1_1_lick_index.html#a3a6724063de1f83fe4db71896427ac1f">cphot::LickIndex::info</a></div><div class="ttdeci">void info() const</div><div class="ttdoc">display some information about the index</div><div class="ttdef"><b>Definition:</b> <a href="licks_8hpp_source.html#l00183">licks.hpp:183</a></div></div>
<div class="ttc" id="aclasscphot_1_1_lick_index_html_af2978a172465f15ee57f7c559a74e32e"><div class="ttname"><a href="classcphot_1_1_lick_index.html#af2978a172465f15ee57f7c559a74e32e">cphot::LickIndex::is_mag</a></div><div class="ttdeci">bool is_mag()</div><div class="ttdef"><b>Definition:</b> <a href="licks_8hpp_source.html#l00126">licks.hpp:126</a></div></div>
<div class="ttc" id="anamespacecphot_html_a56ce8634b8975e1c85f2ca2fb13c45a5"><div class="ttname"><a href="namespacecphot.html#a56ce8634b8975e1c85f2ca2fb13c45a5">cphot::DMatrix</a></div><div class="ttdeci">xt::xarray&lt; double, xt::layout_type::row_major &gt; DMatrix</div><div class="ttdef"><b>Definition:</b> <a href="filter_8hpp_source.html#l00032">filter.hpp:32</a></div></div>
<div class="ttc" id="aclasscphot_1_1_lick_library_html_a2d66054dac73a2b5beb5c39eb7469008"><div class="ttname"><a href="classcphot_1_1_lick_library.html#a2d66054dac73a2b5beb5c39eb7469008">cphot::LickLibrary::load_filter</a></div><div class="ttdeci">LickIndex load_filter(const std::string &amp;filter_name)</div><div class="ttdoc">Load a given filter from the library.</div><div class="ttdef"><b>Definition:</b> <a href="licks_8hpp_source.html#l00321">licks.hpp:321</a></div></div>
<div class="ttc" id="aclasscphot_1_1_lick_library_html_a4022ed25e20bb663e9d5f51852cd2d28"><div class="ttname"><a href="classcphot_1_1_lick_library.html#a4022ed25e20bb663e9d5f51852cd2d28">cphot::LickLibrary::get_content</a></div><div class="ttdeci">std::vector&lt; std::string &gt; get_content()</div><div class="ttdoc">returns the list of lick indices registered</div><div class="ttdef"><b>Definition:</b> <a href="licks_8hpp_source.html#l00280">licks.hpp:280</a></div></div>
<div class="ttc" id="arquantities_8hpp_html_acb72ad7712b661794302d52b25becda0"><div class="ttname"><a href="rquantities_8hpp.html#acb72ad7712b661794302d52b25becda0">angstrom</a></div><div class="ttdeci">constexpr QLength angstrom</div><div class="ttdef"><b>Definition:</b> <a href="rquantities_8hpp_source.html#l00274">rquantities.hpp:274</a></div></div>
<div class="ttc" id="anamespacecphot__licks_html_a5b79dfe60e18681c7575566f070f4550"><div class="ttname"><a href="namespacecphot__licks.html#a5b79dfe60e18681c7575566f070f4550">cphot_licks::lickdefs</a></div><div class="ttdeci">static const std::vector&lt; lickdata &gt; lickdefs({ {&quot;CN_1&quot;, 4142.125, 4177.125, 4080.125, 4117.625, 4244.125, 4284.125, angstrom, true}, {&quot;CN_2&quot;, 4142.125, 4177.125, 4083.875, 4096.375, 4244.125, 4284.125, angstrom, true}, {&quot;Ca4227&quot;, 4222.250, 4234.750, 4211.000, 4219.750, 4241.000, 4251.000, angstrom, false}, {&quot;G4300&quot;, 4281.375, 4316.375, 4266.375, 4282.625, 4318.875, 4335.125, angstrom, false}, {&quot;Fe4383&quot;, 4369.125, 4420.375, 4359.125, 4370.375, 4442.875, 4455.375, angstrom, false}, {&quot;Ca4455&quot;, 4452.125, 4474.625, 4445.875, 4454.625, 4477.125, 4492.125, angstrom, false}, {&quot;Fe4531&quot;, 4514.250, 4559.250, 4504.250, 4514.250, 4560.500, 4579.250, angstrom, false}, {&quot;Fe4668&quot;, 4634.000, 4720.250, 4611.500, 4630.250, 4742.750, 4756.500, angstrom, false}, {&quot;H_beta&quot;, 4847.875, 4876.625, 4827.875, 4847.875, 4876.625, 4891.625, angstrom, false}, {&quot;Fe5015&quot;, 4977.750, 5054.000, 4946.500, 4977.750, 5054.000, 5065.250, angstrom, false}, {&quot;Mg_1&quot;, 5069.125, 5134.125, 4895.125, 4957.625, 5301.125, 5366.125, angstrom, true}, {&quot;Mg_2&quot;, 5154.125, 5196.625, 4895.125, 4957.625, 5301.125, 5366.125, angstrom, true}, {&quot;Mg_b&quot;, 5160.125, 5192.625, 5142.625, 5161.375, 5191.375, 5206.375, angstrom, false}, {&quot;Fe5270&quot;, 5245.650, 5285.650, 5233.150, 5248.150, 5285.650, 5318.150, angstrom, false}, {&quot;Fe5335&quot;, 5312.125, 5352.125, 5304.625, 5315.875, 5353.375, 5363.375, angstrom, false}, {&quot;Fe5406&quot;, 5387.500, 5415.000, 5376.250, 5387.500, 5415.000, 5425.000, angstrom, false}, {&quot;Fe5709&quot;, 5696.625, 5720.375, 5672.875, 5696.625, 5722.875, 5736.625, angstrom, false}, {&quot;Fe5782&quot;, 5776.625, 5796.625, 5765.375, 5775.375, 5797.875, 5811.625, angstrom, false}, {&quot;Na_D&quot;, 5876.875, 5909.375, 5860.625, 5875.625, 5922.125, 5948.125, angstrom, false}, {&quot;TiO_1&quot;, 5936.625, 5994.125, 5816.625, 5849.125, 6038.625, 6103.625, angstrom, true}, {&quot;TiO_2&quot;, 6189.625, 6272.125, 6066.625, 6141.625, 6372.625, 6415.125, angstrom, true}, {&quot;Hdelta_A&quot;, 4083.500, 4122.250, 4041.600, 4079.750, 4128.500, 4161.000, angstrom, false}, {&quot;Hgamma_A&quot;, 4319.750, 4363.500, 4283.500, 4319.750, 4367.250, 4419.750, angstrom, false}, {&quot;Hdelta_F&quot;, 4091.000, 4112.250, 4057.250, 4088.500, 4114.750, 4137.250, angstrom, false}, {&quot;Hgamma_F&quot;, 4331.250, 4352.250, 4283.500, 4319.750, 4354.750, 4384.750, angstrom, false}, {&quot;OIIEW&quot;, 3716.3, 3738.3, 3696.3, 3716.3, 3738.3, 3758.3, angstrom, false}, {&quot;bTiO&quot;, 4758.500, 4800.000, 4742.750, 4756.500, 4827.875, 4847.875, angstrom, false}, {&quot;HdeltaEW&quot;, 4083.5, 4122.250, 4017.0, 4057.0, 4153.0, 4193.0, angstrom, false}, {&quot;NaI&quot;, 8163.500, 8229.125, 8140.000, 8163.500, 8230.250, 8250.000, angstrom, false}, {&quot;HgammaEW&quot;, 4319.750, 4363.5, 4242.0, 4282.0, 4404.0, 4444.0, angstrom, false}, {&quot;CaH_1&quot;, 6357.500, 6401.750, 6342.125, 6356.500, 6408.500, 6429.750, angstrom, true}, {&quot;HbetaEW&quot;, 4847.875, 4876.625, 4799.0, 4839.0, 4886.0, 4926.0, angstrom, false}, {&quot;CaH_2&quot;, 6775.000, 6900.000, 6510.000, 6539.250, 7017.000, 7064.000, angstrom, true}, {&quot;TiO_3&quot;, 7123.750, 7162.500, 7017.000, 7064.000, 7234.000, 7269.000, angstrom, true}, {&quot;TiO_4&quot;, 7643.250, 7717.250, 7527.000, 7577.750, 7735.500, 7782.750, angstrom, true}, {&quot;TiOCaH&quot;, 6600.000, 6817.000, 6520.000, 6545.000, 7035.000, 7050.000, angstrom, false}, {&quot;TiO3&quot;, 6600.000, 6723.000, 6520.000, 6545.000, 7035.000, 7050.000, angstrom, false}, {&quot;CaH&quot;, 6775.000, 6817.000, 6520.000, 6545.000, 7035.000, 7050.000, angstrom, false}, {&quot;aTiO&quot;, 5445.000, 5600.000, 5420.000, 5442.000, 5630.000, 5655.000, angstrom, true}, {&quot;NaI_V12&quot;, 8180.000, 8200.000, 8164.000, 8173.000, 8233.000, 8244.000, angstrom, false}, {&quot;NaI_F13&quot;, 8180.000, 8200.000, 8137.000, 8147.000, 8233.000, 8244.000, angstrom, false}, {&quot;CaHK_LB13&quot;, 3899.47, 4003.47, 3806.50, 3833.82, 4020.69, 4052.36, angstrom, false}, {&quot;Mg4780&quot;, 4760.78, 4798.80, 4738.91, 4757.31, 4819.78, 4835.51, angstrom, false}, {&quot;TiO2SDSS_LB13&quot;, 6189.625, 6272.125, 6066.625, 6141.625, 6442.0, 6455.0, angstrom, true}, {&quot;NaI_LB13&quot;, 8180.000, 8200.000, 8143.000, 8153.000, 8233.000, 8244.000, angstrom, false}, {&quot;Ca1_LB13&quot;, 8484.0, 8513.0, 8474.0, 8484.0, 8563.0, 8577.0, angstrom, false}, {&quot;Ca2_LB13&quot;, 8522.0, 8562.0, 8474.0, 8484.0, 8563.0, 8577.0, angstrom, false}, {&quot;Ca3_LB13&quot;, 8642.0, 8682.0, 8619.0, 8642.0, 8700.0, 8725.0, angstrom, false}, {&quot;Hbeta0&quot;, 4839.275, 4877.097, 4821.175, 4838.404, 4897.445, 4915.845, angstrom, false} })</div></div>
<div class="ttc" id="aclasscphot_1_1_lick_library_html_aa438a6ca8a1731ef28c73fe9ceadb8df"><div class="ttname"><a href="classcphot_1_1_lick_library.html#aa438a6ca8a1731ef28c73fe9ceadb8df">cphot::LickLibrary::LickLibrary</a></div><div class="ttdeci">LickLibrary()</div><div class="ttdoc">Construct a new Lick Library from hard coded definitions.</div><div class="ttdef"><b>Definition:</b> <a href="licks_8hpp_source.html#l00269">licks.hpp:269</a></div></div>
<div class="ttc" id="aclasscphot_1_1_lick_index_html_a5de098256e0088ae6222e94b9a67bc58"><div class="ttname"><a href="classcphot_1_1_lick_index.html#a5de098256e0088ae6222e94b9a67bc58">cphot::LickIndex::get</a></div><div class="ttdeci">double get(const DMatrix &amp;w, const DMatrix &amp;flux, const QLength &amp;wavelength_unit)</div><div class="ttdoc">compute spectral index after continuum subtraction</div><div class="ttdef"><b>Definition:</b> <a href="licks_8hpp_source.html#l00220">licks.hpp:220</a></div></div>
<div class="ttc" id="aclasscphot_1_1_lick_index_html_ad1491361a02f3a807359f774263c6d0e"><div class="ttname"><a href="classcphot_1_1_lick_index.html#ad1491361a02f3a807359f774263c6d0e">cphot::LickIndex::get_name</a></div><div class="ttdeci">std::string get_name() const</div><div class="ttdoc">Get the name object.</div><div class="ttdef"><b>Definition:</b> <a href="licks_8hpp_source.html#l00174">licks.hpp:174</a></div></div>
<div class="ttc" id="aclasscphot_1_1_lick_index_html_a6a429c6546a656a73ea03d1ef4697712"><div class="ttname"><a href="classcphot_1_1_lick_index.html#a6a429c6546a656a73ea03d1ef4697712">cphot::LickIndex::LickIndex</a></div><div class="ttdeci">LickIndex(const std::string &amp;name, double index_band_min, double index_band_max, double blue_continuum_min, double blue_continuum_max, double red_continuum_min, double red_continuum_max, const QLength &amp;wavelength_unit, const std::string &amp;description, bool is_mag)</div><div class="ttdoc">Construct a new Lick Index:: Lick Index object.</div><div class="ttdef"><b>Definition:</b> <a href="licks_8hpp_source.html#l00149">licks.hpp:149</a></div></div>
<div class="ttc" id="anamespacecphot_html"><div class="ttname"><a href="namespacecphot.html">cphot</a></div><div class="ttdef"><b>Definition:</b> <a href="filter_8hpp_source.html#l00030">filter.hpp:30</a></div></div>
<div class="ttc" id="ahelpers_8hpp_html_a0a909be5c801f2d1259dc32bbbdc83e7"><div class="ttname"><a href="helpers_8hpp.html#a0a909be5c801f2d1259dc32bbbdc83e7">tolower</a></div><div class="ttdeci">std::string tolower(std::string s)</div><div class="ttdoc">Returns the lower case of a string.</div><div class="ttdef"><b>Definition:</b> <a href="helpers_8hpp_source.html#l00190">helpers.hpp:190</a></div></div>
<div class="ttc" id="aclasscphot_1_1_lick_library_html"><div class="ttname"><a href="classcphot_1_1_lick_library.html">cphot::LickLibrary</a></div><div class="ttdoc">Collection of Lick indices.</div><div class="ttdef"><b>Definition:</b> <a href="licks_8hpp_source.html#l00249">licks.hpp:249</a></div></div>
<div class="ttc" id="arquantities_8hpp_html_a684e16413e0535dee3da92fe75d71e92"><div class="ttname"><a href="rquantities_8hpp.html#a684e16413e0535dee3da92fe75d71e92">nm</a></div><div class="ttdeci">constexpr QLength nm</div><div class="ttdef"><b>Definition:</b> <a href="rquantities_8hpp_source.html#l00273">rquantities.hpp:273</a></div></div>
<div class="ttc" id="anamespacecphot__sun__theoretical_html_af87284c9a76c080728b33c14948be461"><div class="ttname"><a href="namespacecphot__sun__theoretical.html#af87284c9a76c080728b33c14948be461">cphot_sun_theoretical::wavelength_unit</a></div><div class="ttdeci">const QLength wavelength_unit</div><div class="ttdef"><b>Definition:</b> <a href="sun__data_8hpp_source.html#l00019">sun_data.hpp:19</a></div></div>
<div class="ttc" id="astructcphot__licks_1_1lickdata_html"><div class="ttname"><a href="structcphot__licks_1_1lickdata.html">cphot_licks::lickdata</a></div><div class="ttdoc">Stores the definition of a Lick index.</div><div class="ttdef"><b>Definition:</b> <a href="licks__data_8hpp_source.html#l00026">licks_data.hpp:26</a></div></div>
<!-- HTML footer for doxygen 1.9.2-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_e37379ab7a03e54c0f4718c7a2cedb90.html">cphot</a></li><li class="navelem"><a class="el" href="licks_8hpp.html">licks.hpp</a></li>
    <li class="footer">Generated on Thu Dec 16 2021 14:06:41 for cphot by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
